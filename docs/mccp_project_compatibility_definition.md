# `compatibility_file_definition.md`

## MCCP 兼容性描述文件 `mccp_config.json` 定义

### 1. 引言

在 MCCP (Model Context Code Protocol) 项目中，`mccp_config.json` 文件扮演着至关重要的“配置文件”角色。它的核心目的是描述当前 MCCP 工程构建所需的关键外部依赖和环境信息。通过明确这些兼容性要素，该文件确保了团队协作的一致性、工程构建的可预测性以及最终生成代码的可移植性。它是连接抽象层级与实际构建环境之间的桥梁。

### 2. 文件结构与格式

`mccp_config.json` 文件是一个标准的 JSON (JavaScript Object Notation) 格式文件。JSON 格式因其轻量、易读和结构化特性，非常适合用作配置文件。

```text
// mccp_config.json 文件结构示例
{
    "mccp_version": "...",
    "project_name": "...",
    "llm_used": "...",
    "target_language": "...",
    "dependencies": {
        "standard_libraries": [
            "..."
        ],
        "third_party_libraries": {
            "...": "..."
        },
        "local_code_bases": [
            {
                "name": "...",
                "path": "...",
                "version": "..."
            }
        ]
    },
    "build_settings": {
        "...": "..."
    }
}
```

### 3. 核心字段详解

`mccp_config.json` 文件包含多个关键字段，用于定义 MCCP 工程的构建环境和依赖。以下是根据 MCCP 核心文档提供的原文进行的详细解释：

| 字段名称          | 对应的 JSON Key     | 含义与用途说明                                                                                                                                                                                                                                                           | 示例值或配置格式                                                                                                                                                                                              |
| :---------------- | :------------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 目标大模型    | `llm_used`          | 定义当前 MCCP 工程在构建（生成代码）时期望调用和适配的具体大语言模型。指定模型（如 Qwen, ChatGPT, DeepSeek）有助于确保协作开发人员使用相同或兼容的模型版本，从而降低因模型差异性导致的难以解决的合并冲突问题，提高代码生成的一致性和可预测性。这是确保不同个体或团队基于同一 MCCP 描述文件生成相似代码的前提。 | `"GPT-4o"`, `"Qwen-1.5-14B"`, `"DeepSeek-Coder"`                                                                                                                                                             |
| 目标编程语言  | `target_language`   | 明确该 MCCP 工程最终将要生成代码的具体编程语言（如 Python, C++, JAVA）。虽然 MCCP 理论上应可构建为任何具备完备性的现代编程语言，但考虑到不同语言：<br/>- *特定功能意义*<br/>- *独特的语法定义/函数库/功能糖*<br/>限定目标语言是出于兼容性和可构建性的考量。它指导大模型在符号-伪代码层向实际代码转换时遵循特定的语言范式和约定。 | `"Python"`, `"C++"`, `"JAVA"`, `"Go"`                                                                                                                                                                         |
| 依赖库/源代码库 | `dependencies`      | 定义当前 MCCP 工程在构建和运行时需要依赖的外部功能库、第三方库或本地现有源代码库。现代软件工程高度依赖库。此字段用于：<br/>- 声明所需的标准库（语言内置或常用）<br/>- 指定所需的第三方库及其版本<br/>- 引用本地或内部的代码库<br/>明确这些依赖并进行版本对齐是避免“重复造轮子”、确保代码可构建和运行的关键。它向大模型提供了生成 `import` 语句、调用外部函数或类所需的信息。 | ```json<br/>{<br/>  "standard_libraries": ["json", "sys"],<br/>  "third_party_libraries": {<br/>    "requests": "2.28.1",<br/>    "pytest": "7.0.0"<br/>  },<br/>  "local_code_bases": [<br/>    {<br/>      "name": "my_common_utils",<br/>      "path": "../my_common_utils_repo",<br/>      "version": "1.2.0"<br/>    }<br/>  ]<br/>} ``` |
| MCCP 版本     | `mccp_version`      | 标识该 `mccp_config.json` 文件及关联的 MCCP 工程所遵循的 MCCP 协议版本。对于快速演进的 MCCP 协议而言，版本管理至关重要，有助于构建器或工具识别和处理不同版本的协议文件。 | `"0.1"`                                                                                                                                                                                                       |
| 项目名称      | `project_name`      | 项目的标识名称。有助于组织和管理多个 MCCP 工程。                                                                                                                                                                                                                          | `"SimpleCalculator"`                                                                                                                                                                                          |
| 构建设置      | `build_settings`    | 包含与代码生成或项目构建过程相关的可选设置。例如输出目录、优化开关等。这些设置可能因具体的 MCCP 构建工具而异。                                                                                                                                                               | ```json<br/>{<br/>  "output_directory": "generated_src",<br/>  "enable_optimizations": false<br/>}```                                                                                                     |

> `mccp_config.json` 文件对应于传统软件工程中的“配置文件”的概念。

### 4. 使用与维护

`mccp_config.json` 文件通常在 MCCP 工程初始化或需求初步拆解至行为描述层阶段被定义和确定其基本内容。

在 MCCP 的工作流程中，该文件在正向构建和反向构建过程中均被使用：

* 正向构建: 当从行为描述层和符号-伪代码层生成最终的目标编程语言代码时，构建工具和调用的语言模型会参考 `mccp_config.json` 中指定的目标语言和依赖库信息，以生成符合特定环境和依赖关系的代码。
* 反向构建: 在将现有源代码适配到 MCCP 框架的过程中，反向构建脚本或工具会优先分析现有代码，识别其使用的编程语言、依赖库（包括标准库、第三方库和内部库及其版本），然后构建并确定 `mccp_config.json` 文件。这确保了反向构建生成的 MCCP 描述文件能够准确反映原始工程的环境信息，为后续的迭代开发提供基础。

虽然 `mccp_config.json` 的核心字段在项目生命周期中相对稳定，但当项目需求或环境发生变化时（例如更换大模型、增加或升级依赖库），该文件需要进行相应的维护和更新，并确保团队成员之间同步这些变更。

### 5. 总结

作为 MCCP 工程的兼容性描述文件，`mccp_config.json` 文件是确保项目一致性、可移植性和可维护性的基石。它通过明确指定所依赖的大模型、目标编程语言以及项目依赖库，为 MCCP 的正向和反向构建过程提供了关键的环境上下文。准确和及时的维护此文件，对于 MCCP 工程的顺利进行和高质量代码的生成至关重要。
